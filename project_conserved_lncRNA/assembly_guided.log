nohup: ignoring input
INFO 2018-03-22 13:33:04,962 src.utils            Running RNASeqPipeline 0.2.2
INFO 2018-03-22 13:33:04,962 src.utils            Command-line /home/yixf/miniconda2/envs/RNACocktail/bin/run_rnacocktail.py align --align_idx 00_genome/hisat2_hg38/hg38 --outdir 03_guided_out --workdir 03_guided_work --ref_gtf 00_genes/hg38.gtf --1 02_fastq/human/HB01_1.fastq --2 02_fastq/human/HB01_2.fastq --threads 30 --sample HB01
INFO 2018-03-22 13:33:04,962 src.utils            Arguments are Namespace(1='02_fastq/human/HB01_1.fastq', 2='02_fastq/human/HB01_2.fastq', U='', align_idx='00_genome/hisat2_hg38/hg38', hisat2='hisat2', hisat2_opts='', hisat2_sps='hisat2_extract_splice_sites.py', mode='align', outdir='03_guided_out', ref_gtf='00_genes/hg38.gtf', sample='HB01', samtools='samtools', sr_aligner='HISAT2', sra='', start=0, threads=30, timeout=10000000, workdir='03_guided_work')
INFO 2018-03-22 13:33:04,962 src.utils            Run log will be saved in 03_guided_work/logs/run-align-20180322-133304.log
INFO 2018-03-22 13:33:04,962 src.utils            Run in mode: align
INFO 2018-03-22 13:33:04,962 src.utils            Assigned sample ID: HB01
INFO 2018-03-22 13:33:04,963 src.utils            Running align step using HISAT2
INFO 2018-03-22 13:33:04,963 src.run_sr_align     Running alignment (HISAT2) for HB01
INFO 2018-03-22 13:33:04,963 src.utils            Creating directory 03_guided_work/hisat2/HB01
INFO 2018-03-22 13:33:04,963 src.run_sr_align     --------------------------STEP 0--------------------------
INFO 2018-03-22 13:33:04,963 src.run_sr_align     Task: Erase HISAT2 work directory for HB01 
INFO 2018-03-22 13:33:04,964 src.run_sr_align     Running "bash -c rm -rf 03_guided_work/hisat2/HB01/*" 
INFO 2018-03-22 13:33:04,970 src.run_sr_align     Done Erase HISAT2 work directory for HB01 
INFO 2018-03-22 13:33:04,970 src.run_sr_align     Returned code 0 (0.00366807 seconds)
INFO 2018-03-22 13:33:04,971 src.run_sr_align     --------------------------STEP 1--------------------------
INFO 2018-03-22 13:33:04,971 src.run_sr_align     Task: compute --known-splicesite-infile for HISAT2 
INFO 2018-03-22 13:33:04,971 src.run_sr_align     Running "bash -c hisat2_extract_splice_sites.py 00_genes/hg38.gtf" 
INFO 2018-03-22 13:33:36,751 src.run_sr_align     Done compute --known-splicesite-infile for HISAT2 
INFO 2018-03-22 13:33:36,751 src.run_sr_align     Returned code 0 (31.7772 seconds)
INFO 2018-03-22 13:33:36,752 src.run_sr_align     --------------------------STEP 2--------------------------
INFO 2018-03-22 13:33:36,753 src.run_sr_align     Task: HISAT2 for HB01 
INFO 2018-03-22 13:33:36,753 src.run_sr_align     Running "bash -c hisat2  --dta --rg-id hisat2 --rg SM:HB01 --threads 30 --known-splicesite-infile 03_guided_work/hisat2/HB01/known-splicesite.txt  -x 00_genome/hisat2_hg38/hg38 -1 02_fastq/human/HB01_1.fastq -2 02_fastq/human/HB01_2.fastq -S 03_guided_work/hisat2/HB01/alignments.sam --novel-splicesite-outfile 03_guided_work/hisat2/HB01/splicesites.tab" 
INFO 2018-03-22 13:35:29,112 src.run_sr_align     Done HISAT2 for HB01 
INFO 2018-03-22 13:35:29,112 src.run_sr_align     Returned code 0 (112.355 seconds)
INFO 2018-03-22 13:35:29,112 src.run_sr_align     --------------------------STEP 3--------------------------
INFO 2018-03-22 13:35:29,113 src.run_sr_align     Task: converting SAM to BAM for HB01 
INFO 2018-03-22 13:35:29,113 src.run_sr_align     Running "bash -c samtools view -Su 03_guided_work/hisat2/HB01/alignments.sam -@ 30 -o 03_guided_work/hisat2/HB01/alignments.bam" 
INFO 2018-03-22 13:36:04,270 src.run_sr_align     Done converting SAM to BAM for HB01 
INFO 2018-03-22 13:36:04,271 src.run_sr_align     Returned code 0 (35.1535 seconds)
INFO 2018-03-22 13:36:04,271 src.run_sr_align     --------------------------STEP 4--------------------------
INFO 2018-03-22 13:36:04,271 src.run_sr_align     Task: sorting BAM for HB01 
INFO 2018-03-22 13:36:04,272 src.run_sr_align     Running "bash -c samtools sort  -@ 30 -T 03_guided_work/hisat2/HB01/alignments.sorted -o 03_guided_work/hisat2/HB01/alignments.sorted.bam 03_guided_work/hisat2/HB01/alignments.bam  " 
INFO 2018-03-22 13:36:47,962 src.run_sr_align     Done sorting BAM for HB01 
INFO 2018-03-22 13:36:47,962 src.run_sr_align     Returned code 0 (43.6862 seconds)
INFO 2018-03-22 13:36:47,962 src.run_sr_align     --------------------------STEP 5--------------------------
INFO 2018-03-22 13:36:47,962 src.run_sr_align     Task: Converting junctions to BED for HB01 
INFO 2018-03-22 13:36:47,963 src.run_sr_align     Running "bash -c hisat2_jun2bed.py 03_guided_work/hisat2/HB01/splicesites.tab 03_guided_work/hisat2/HB01/splicesites.bed " 
INFO 2018-03-22 13:36:49,154 src.run_sr_align     Done Converting junctions to BED for HB01 
INFO 2018-03-22 13:36:49,154 src.run_sr_align     Returned code 0 (1.18868 seconds)
INFO 2018-03-22 13:36:49,155 src.run_sr_align     --------------------------STEP 6--------------------------
INFO 2018-03-22 13:36:49,155 src.run_sr_align     Task: Clean temp alignment files for HB01 
INFO 2018-03-22 13:36:49,155 src.run_sr_align     Running "bash -c rm 03_guided_work/hisat2/HB01/alignments.sam 03_guided_work/hisat2/HB01/alignments.bam" 
INFO 2018-03-22 13:36:51,768 src.run_sr_align     Done Clean temp alignment files for HB01 
INFO 2018-03-22 13:36:51,768 src.run_sr_align     Returned code 0 (2.6091 seconds)
INFO 2018-03-22 13:36:51,768 src.utils            Creating directory 03_guided_out/hisat2/HB01
INFO 2018-03-22 13:36:51,769 src.run_sr_align     --------------------------STEP 7--------------------------
INFO 2018-03-22 13:36:51,769 src.run_sr_align     Task: Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:36:51,770 src.run_sr_align     Running "cp 03_guided_work/hisat2/HB01/alignments.sorted.bam 03_guided_out/hisat2/HB01/alignments.sorted.bam" 
INFO 2018-03-22 13:36:52,859 src.run_sr_align     Done Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:36:52,859 src.run_sr_align     Returned code 0 (1.0857 seconds)
INFO 2018-03-22 13:36:52,860 src.run_sr_align     Task: Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:36:52,860 src.run_sr_align     Running "cp 03_guided_work/hisat2/HB01/splicesites.tab 03_guided_out/hisat2/HB01/splicesites.tab" 
INFO 2018-03-22 13:36:52,870 src.run_sr_align     Done Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:36:52,870 src.run_sr_align     Returned code 0 (0.00613713 seconds)
INFO 2018-03-22 13:36:52,871 src.run_sr_align     Task: Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:36:52,871 src.run_sr_align     Running "cp 03_guided_work/hisat2/HB01/splicesites.bed 03_guided_out/hisat2/HB01/splicesites.bed" 
INFO 2018-03-22 13:36:52,888 src.run_sr_align     Done Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:36:52,888 src.run_sr_align     Returned code 0 (0.0144429 seconds)
INFO 2018-03-22 13:36:52,889 src.run_sr_align     HISAT2 was successfull!
INFO 2018-03-22 13:36:52,889 src.run_sr_align     Output alignment: 03_guided_out/hisat2/HB01/alignments.sorted.bam
INFO 2018-03-22 13:36:52,889 src.run_sr_align     Output junction tab: 03_guided_out/hisat2/HB01/splicesites.tab
INFO 2018-03-22 13:36:52,889 src.run_sr_align     Output junction bed: 03_guided_out/hisat2/HB01/splicesites.bed
INFO 2018-03-22 13:36:52,889 src.utils            Run log is saved in 03_guided_work/logs/run-align-20180322-133304.log
INFO 2018-03-22 13:36:52,889 src.utils            All Done!
INFO 2018-03-22 13:36:53,210 src.utils            Running RNASeqPipeline 0.2.2
INFO 2018-03-22 13:36:53,211 src.utils            Command-line /home/yixf/miniconda2/envs/RNACocktail/bin/run_rnacocktail.py reconstruct --alignment_bam 03_guided_out/hisat2/HB01/alignments.sorted.bam --outdir 03_guided_out --workdir 03_guided_work --ref_gtf 00_genes/hg38.gtf --threads 30 --sample HB01
INFO 2018-03-22 13:36:53,211 src.utils            Arguments are Namespace(alignment_bam='03_guided_out/hisat2/HB01/alignments.sorted.bam', mode='reconstruct', outdir='03_guided_out', reconstructor='StringTie', ref_gtf='00_genes/hg38.gtf', sample='HB01', start=0, stringtie='stringtie', stringtie_opts='', threads=30, timeout=10000000, workdir='03_guided_work')
INFO 2018-03-22 13:36:53,211 src.utils            Run log will be saved in 03_guided_work/logs/run-reconstruct-20180322-133653.log
INFO 2018-03-22 13:36:53,211 src.utils            Run in mode: reconstruct
INFO 2018-03-22 13:36:53,211 src.utils            Assigned sample ID: HB01
INFO 2018-03-22 13:36:53,211 src.utils            Running reconstruct step using StringTie
INFO 2018-03-22 13:36:53,211 src.run_reconstruct  Running transcriptome reconstruction (StringTie) for HB01
INFO 2018-03-22 13:36:53,211 src.utils            Creating directory 03_guided_work/stringtie/HB01/
INFO 2018-03-22 13:36:53,212 src.run_reconstruct  --------------------------STEP 0--------------------------
INFO 2018-03-22 13:36:53,212 src.run_reconstruct  Task: Erase StringTie work directory for HB01 
INFO 2018-03-22 13:36:53,212 src.run_reconstruct  Running "bash -c rm -rf 03_guided_work/stringtie/HB01//*" 
INFO 2018-03-22 13:36:53,217 src.run_reconstruct  Done Erase StringTie work directory for HB01 
INFO 2018-03-22 13:36:53,217 src.run_reconstruct  Returned code 0 (0.00265408 seconds)
INFO 2018-03-22 13:36:53,217 src.run_reconstruct  --------------------------STEP 1--------------------------
INFO 2018-03-22 13:36:53,217 src.run_reconstruct  Task: StringTie for HB01 
INFO 2018-03-22 13:36:53,218 src.run_reconstruct  Running "bash -c stringtie 03_guided_out/hisat2/HB01/alignments.sorted.bam  -G 00_genes/hg38.gtf -p 30 -o 03_guided_work/stringtie/HB01//transcripts.gtf -A 03_guided_work/stringtie/HB01//gene_abund.tab -v" 
INFO 2018-03-22 13:39:31,451 src.run_reconstruct  Done StringTie for HB01 
INFO 2018-03-22 13:39:31,452 src.run_reconstruct  Returned code 0 (158.231 seconds)
INFO 2018-03-22 13:39:31,452 src.utils            Creating directory 03_guided_out/stringtie/HB01
INFO 2018-03-22 13:39:31,452 src.run_reconstruct  --------------------------STEP 2--------------------------
INFO 2018-03-22 13:39:31,452 src.run_reconstruct  Task: Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:39:31,453 src.run_reconstruct  Running "cp 03_guided_work/stringtie/HB01//transcripts.gtf 03_guided_out/stringtie/HB01/transcripts.gtf" 
INFO 2018-03-22 13:39:31,589 src.run_reconstruct  Done Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:39:31,590 src.run_reconstruct  Returned code 0 (0.132499 seconds)
INFO 2018-03-22 13:39:31,590 src.run_reconstruct  Task: Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:39:31,590 src.run_reconstruct  Running "cp 03_guided_work/stringtie/HB01//gene_abund.tab 03_guided_out/stringtie/HB01/gene_abund.tab" 
INFO 2018-03-22 13:39:31,605 src.run_reconstruct  Done Copy predictions to output directory for HB01. 
INFO 2018-03-22 13:39:31,606 src.run_reconstruct  Returned code 0 (0.0107911 seconds)
INFO 2018-03-22 13:39:31,606 src.run_reconstruct  StringTie was successfull!
INFO 2018-03-22 13:39:31,606 src.run_reconstruct  Output isoforms: 03_guided_out/stringtie/HB01/transcripts.gtf
INFO 2018-03-22 13:39:31,606 src.run_reconstruct  Output expressions: 03_guided_out/stringtie/HB01/gene_abund.tab
INFO 2018-03-22 13:39:31,606 src.utils            Run log is saved in 03_guided_work/logs/run-reconstruct-20180322-133653.log
INFO 2018-03-22 13:39:31,607 src.utils            All Done!
INFO 2018-03-22 13:39:31,994 src.utils            Running RNASeqPipeline 0.2.2
INFO 2018-03-22 13:39:31,994 src.utils            Command-line /home/yixf/miniconda2/envs/RNACocktail/bin/run_rnacocktail.py align --align_idx 00_genome/hisat2_hg38/hg38 --outdir 03_guided_out --workdir 03_guided_work --ref_gtf 00_genes/hg38.gtf --1 02_fastq/human/HB02_1.fastq --2 02_fastq/human/HB02_2.fastq --threads 30 --sample HB02
INFO 2018-03-22 13:39:31,994 src.utils            Arguments are Namespace(1='02_fastq/human/HB02_1.fastq', 2='02_fastq/human/HB02_2.fastq', U='', align_idx='00_genome/hisat2_hg38/hg38', hisat2='hisat2', hisat2_opts='', hisat2_sps='hisat2_extract_splice_sites.py', mode='align', outdir='03_guided_out', ref_gtf='00_genes/hg38.gtf', sample='HB02', samtools='samtools', sr_aligner='HISAT2', sra='', start=0, threads=30, timeout=10000000, workdir='03_guided_work')
INFO 2018-03-22 13:39:31,994 src.utils            Run log will be saved in 03_guided_work/logs/run-align-20180322-133931.log
INFO 2018-03-22 13:39:31,995 src.utils            Run in mode: align
INFO 2018-03-22 13:39:31,995 src.utils            Assigned sample ID: HB02
INFO 2018-03-22 13:39:31,995 src.utils            Running align step using HISAT2
INFO 2018-03-22 13:39:31,995 src.run_sr_align     Running alignment (HISAT2) for HB02
INFO 2018-03-22 13:39:31,995 src.utils            Creating directory 03_guided_work/hisat2/HB02
INFO 2018-03-22 13:39:31,995 src.run_sr_align     --------------------------STEP 0--------------------------
INFO 2018-03-22 13:39:31,995 src.run_sr_align     Task: Erase HISAT2 work directory for HB02 
INFO 2018-03-22 13:39:31,996 src.run_sr_align     Running "bash -c rm -rf 03_guided_work/hisat2/HB02/*" 
INFO 2018-03-22 13:39:32,003 src.run_sr_align     Done Erase HISAT2 work directory for HB02 
INFO 2018-03-22 13:39:32,004 src.run_sr_align     Returned code 0 (0.00457716 seconds)
INFO 2018-03-22 13:39:32,004 src.run_sr_align     --------------------------STEP 1--------------------------
INFO 2018-03-22 13:39:32,004 src.run_sr_align     Task: compute --known-splicesite-infile for HISAT2 
INFO 2018-03-22 13:39:32,004 src.run_sr_align     Running "bash -c hisat2_extract_splice_sites.py 00_genes/hg38.gtf" 
INFO 2018-03-22 13:40:04,011 src.run_sr_align     Done compute --known-splicesite-infile for HISAT2 
INFO 2018-03-22 13:40:04,012 src.run_sr_align     Returned code 0 (32.0045 seconds)
INFO 2018-03-22 13:40:04,012 src.run_sr_align     --------------------------STEP 2--------------------------
INFO 2018-03-22 13:40:04,013 src.run_sr_align     Task: HISAT2 for HB02 
INFO 2018-03-22 13:40:04,013 src.run_sr_align     Running "bash -c hisat2  --dta --rg-id hisat2 --rg SM:HB02 --threads 30 --known-splicesite-infile 03_guided_work/hisat2/HB02/known-splicesite.txt  -x 00_genome/hisat2_hg38/hg38 -1 02_fastq/human/HB02_1.fastq -2 02_fastq/human/HB02_2.fastq -S 03_guided_work/hisat2/HB02/alignments.sam --novel-splicesite-outfile 03_guided_work/hisat2/HB02/splicesites.tab" 
